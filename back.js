"rhino";(()=>{"use strict";var e={9575:function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ON_WS_MESSAGE=t.IHandlerFactory=t.IHandler=t.IHandlerStatus=void 0,t.getAllHandler=function getAllHandler(){return i},t.createHandler=function createHandler(e,r){var n=(0,a.useInjector)().get(t.ON_WS_MESSAGE).find((function(t){return t.action===e}));if(n)return n.create(r)},t.startHandler=function startHandler(e){try{if("sync"===e.category)return e.start(),!0;if("async"===e.category)return e.start(),!0;if(i.length>0){var t=i.filter((function(t){return t.id===e.id}));if(t&&t.length>0)for(var r=0,n=t;r<n.length;r++){destoryHandler(n[r])}}return i.push(e),e.status=o.starting,e.start(),e.events.start&&e.events.start(!0),e.status=o.started,!0}catch(t){return e.error(t),!1}},t.getHandlerById=function getHandlerById(e){return i.find((function(t){return t.id===e}))},t.stopHandler=stopHandler,t.resumeHandler=function resumeHandler(e){try{if(i.length>0)stopHandler(i[i.length-1]);return e.status=o.resuming,e.resume(),e.events.resume&&e.events.resume(!0),e.status=o.resumed,i=n(n([],i.filter((function(t){return t!==e})),!0),[e],!1),!0}catch(t){return e.error(t),!1}},t.destoryHandler=destoryHandler,t.destoryAllHandler=function destoryAllHandler(){for(l.map((function(e){return e.destory()})),l=[];;){var e=i.pop();if(!e)break;destoryHandler(e)}};var o,a=r(8217);!function(e){e[e.starting=1]="starting",e[e.started=2]="started",e[e.runing=3]="runing",e[e.stoping=4]="stoping",e[e.stoped=5]="stoped",e[e.destoring=6]="destoring",e[e.destoried=7]="destoried",e[e.resuming=8]="resuming",e[e.resumed=9]="resumed"}(o||(t.IHandlerStatus=o={}));var i=[];var c=function(){function IHandler(){this.id=Date.now(),this.category="task",this.events={},this.status=o.destoried}return IHandler.prototype.__stop=function(){return this.stop()},IHandler}();t.IHandler=c;var s=function s(){};t.IHandlerFactory=s,t.ON_WS_MESSAGE="ON_WS_MESSAGE";var l=[];function stopHandler(e){try{return e.status=o.stoping,e.__stop(),e.events.stop&&e.events.stop(!0),e.status=o.stoped,!0}catch(t){return e.error(t),!1}}function destoryHandler(e){try{return e.status=o.destoring,e.destory(),e.events.destory&&e.events.destory(!0),e.status=o.destoried,i=i.filter((function(t){return t!==e})),!0}catch(t){return e.error(t),!1}}},4890:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.CoreHandler=void 0;var a=r(9575),i=r(8217),c=r(6757),s=r(2269),l=function(e){function CoreHandler(){return null!==e&&e.apply(this,arguments)||this}return o(CoreHandler,e),CoreHandler.prototype.response=function(e,t){void 0===e&&(e={}),(0,i.useInjector)().get(s.WebSocket).response(this.payload,e,t),"async"===this.category&&this.__stop()},CoreHandler.prototype.recyle=function(e){e&&(e.recycle(),e=null)},Object.defineProperty(CoreHandler.prototype,"data",{get:function(){return this.payload.data},enumerable:!1,configurable:!0}),CoreHandler.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,i.useInjector)().get(c.Console);r.log.apply(r,e)},CoreHandler.prototype.on=function(e,t){this.events[e]=t},CoreHandler.prototype.until=function(e){void 0===e&&(e=0),this.thread&&this.thread.join(e)},CoreHandler}(a.IHandler);t.CoreHandler=l},9292:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalInjectorNotFoundError=t.AstNotFoundError=void 0;var o=function(e){function AstNotFoundError(t){return e.call(this,t)||this}return n(AstNotFoundError,e),AstNotFoundError}(Error);t.AstNotFoundError=o;var a=function(e){function GlobalInjectorNotFoundError(){return e.call(this,"[GlobalInjectorNotFoundError]injector is undefined")||this}return n(GlobalInjectorNotFoundError,e),GlobalInjectorNotFoundError}(Error);t.GlobalInjectorNotFoundError=a},8217:function(e,t,r){var n=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useInjector=function useInjector(){if(o)return o;throw new a.GlobalInjectorNotFoundError},t.setInjector=setInjector,t.createFactory=function createFactory(e){var t=new Map,r=new Map;function createProviderInstance(e){return(0,c.isTypeProvider)(e)?new e(inject):(0,c.isClassProvider)(e)?new e.useClass(inject):(0,c.isValueProvider)(e)?e.useValue:(0,c.isFactoryProvider)(e)?e.useFactory(inject):(0,c.isExistingProvider)(e)?inject(e.useExisting):new e.provide(inject)}function inject(e){if(r.has(e))return r.get(e);var n=t.get(e);if(n){if(Array.isArray(n)){var o=n.map((function(e){return createProviderInstance(e)}));return r.set(e,o),o}var a=createProviderInstance(n);return r.set(e,a),a}throw new c.NotFoundToken("not found token",e)}return inject.get=inject,function(r){n(n([],e,!0),r,!0).map((function(e){if((0,c.isTypeProvider)(e))t.set(e,e);else if(e.multi){var r=t.get(e.provide)||[];if(Array.isArray(r))return void t.set(e.provide,n(n([],r,!0),[e],!1))}else t.set(e.provide,e)})),setInjector(inject);var o=inject(i.SET_UP_TOKEN);return Array.isArray(o)&&o.reverse().map((function(e){return e(inject)})),inject}};var o,a=r(9292),i=r(6757),c=r(8658);function setInjector(e){o=e}},4163:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(8658),t),o(r(3674),t),o(r(7399),t),o(r(6757),t),o(r(8217),t),o(r(9575),t),o(r(2269),t),o(r(8079),t),o(r(2766),t)},8380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Loadder=void 0;var r=function r(){};t.Loadder=r},2766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=function bootstrap(){try{(0,n.platformV1)([]);var e=(0,n.useToken)(n.DEV_DEBUGGER,!1),t=(0,n.useToken)(n.FORCE_STOP,!1);e.put(!0),t.put(!1),events.on("exit",(function(){t.put(!0),(0,n.destoryAllHandler)()}))}catch(e){console.log(e)}};var n=r(4163)},6757:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.AstVisitor=t.Visitor=t.Events=t.Console=t.PAGE_TO_HANDLER=t.PageToHandler=t.PAGE_HANDLER=t.PageHandler=t.AST_HANDLER=t.AstHandler=t.App=t.Auto=t.WEB_SOCKET_URL=t.DEVICE_ID=t.ON_DESTORY_TOKEN=t.SET_UP_TOKEN=t.FORCE_STOP=t.OCR_TYPE_TOKEN=t.VSCODE_ID=t.DEV_DEBUGGER=t.RUN_DAY_STEP=t.RUN_TEST_STEP=t.RUN_STEP=t.Storage=t.defaultSetting=t.SETTING_TOKEN=void 0,t.SETTING_TOKEN="SETTING_TOKEN",t.defaultSetting={ip:"43.240.223.138",port:3001,debugModel:!0,debugSleep:1e3,showWebSocketLog:!0,showRemtoeExecScriptContent:!0,autoRun:!0,ocr:"",showFloaty:!0,standardHeight:1024,standardWidth:768};var o=function o(){};t.Storage=o,t.RUN_STEP="RUN_STEP",t.RUN_TEST_STEP="RUN_TEST_STEP",t.RUN_DAY_STEP="RUN_DAY_STEP",t.DEV_DEBUGGER="DEV_DEBUGGER",t.VSCODE_ID="VSCODE_ID",t.OCR_TYPE_TOKEN="OCR_TYPE_TOKEN",t.FORCE_STOP="FORCE_STOP",t.SET_UP_TOKEN="SET_UP_TOKEN",t.ON_DESTORY_TOKEN="ON_DESTORY_TOKEN",t.DEVICE_ID="DEVICE_ID",t.WEB_SOCKET_URL="WEB_SOCKET_URL";var a=function a(){};t.Auto=a;var i=function i(){};t.App=i;var c=function c(){};t.AstHandler=c,t.AST_HANDLER="AST_HANDLER";var s=function s(){};t.PageHandler=s,t.PAGE_HANDLER="PAGE_HANDLER";var l=function l(){};t.PageToHandler=l,t.PAGE_TO_HANDLER="PAGE_TO_HANDLER";var u=function u(){};t.Console=u;var p=function p(){};t.Events=p;var d=function(){function Visitor(){}return Visitor.prototype.toJson=function(e){if(e)return JSON.stringify(e,null,2)},Visitor}();t.Visitor=d;var y=function(e){function AstVisitor(){return null!==e&&e.apply(this,arguments)||this}return n(AstVisitor,e),AstVisitor}(d);t.AstVisitor=y},8658:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderMultiMustBeArrayError=t.NotFoundToken=t.version=void 0,t.isOnInit=function isOnInit(e){return e&&"function"==typeof e.onInit},t.isOnDestory=function isOnDestory(e){return e&&"function"==typeof e.onDestory},t.isValueProvider=function isValueProvider(e){return e&&e.useValue},t.isExistingProvider=function isExistingProvider(e){return e&&e.useExisting},t.isFactoryProvider=function isFactoryProvider(e){return e&&"function"==typeof e.useFactory},t.isTypeProvider=isTypeProvider,t.isClassProvider=function isClassProvider(e){return e&&isTypeProvider(e.useClass)},t.version="1.0.0";var o=function(e){function NotFoundToken(t,r){var n=e.call(this,t)||this;return n.token=r,n}return n(NotFoundToken,e),NotFoundToken}(Error);function isTypeProvider(e){return e&&"function"==typeof e}t.NotFoundToken=o;var a=function(e){function ProviderMultiMustBeArrayError(){return null!==e&&e.apply(this,arguments)||this}return n(ProviderMultiMustBeArrayError,e),ProviderMultiMustBeArrayError}(Error);t.ProviderMultiMustBeArrayError=a},8368:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageUtil=void 0;var r=function r(){};t.ImageUtil=r},6107:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Device=void 0;var r=function r(){};t.Device=r},8079:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.useStorage=useStorage,t.useToken=function useToken(e,t){if(a.has(e))return a.get(e);var r={get:function(){var r=useStorage().get(e);return void 0===r?t:r},put:function(t){return useStorage().put(e,t)}};return a.set(e,r),r};var n=r(8217),o=r(6757);function useStorage(){return(0,n.useInjector)()(o.Storage)}var a=new Map},1531:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRandomString=void 0,t.calculateTextSimilarity=function calculateTextSimilarity(e,t){var r=function levenshteinDistance(e,t){for(var r=[],n=0;n<=t.length;n++)r[n]=[n];for(var o=0;o<=e.length;o++)r[0][o]=o;for(n=1;n<=t.length;n++)for(o=1;o<=e.length;o++){var a=e[o-1]===t[n-1]?0:1;r[n][o]=Math.min(r[n-1][o]+1,r[n][o-1]+1,r[n-1][o-1]+a)}return r[t.length][e.length]}(e,t),n=Math.max(e.length,t.length);return 1-r/n};t.createRandomString=function(e){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r="",n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}},3674:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.platformV1=void 0;var n=r(6757),o=r(8217),a=r(2269),i=r(8380),c=r(6806),s=r(8430),l=r(8079),u=r(9575),p=r(1561),d=r(5049),y=r(7799),f=r(9163),h=r(3702),_=r(340),g=r(2968),v=r(8656),H=r(1246),m=r(1771),b=r(9557),S=r(961),O=r(6107),w=r(2003),C=r(8368),F=r(8920),E=r(5486),j=r(3605),P=r(5816),I=r(692),x=r(105),T=r(9182),k=r(8842),A=r(1890),G=r(3341),V=r(4993),M=r(1938),D=r(5820),N=r(4771),R=r(4472),L=r(975),W=r(2134),U=r(234),B=r(9768),J=r(2601),X=r(5504),K=r(9123),Y=r(939),q=r(3706),z=r(8877);t.platformV1=(0,o.createFactory)([{provide:n.Storage,useFactory:function(){return storages.create("org.sker.baihu")}},{provide:i.Loadder,useClass:c.LoadderV1},{provide:a.WebSocket,useClass:s.WebSocketV1},{provide:n.Console,useClass:g.ConsoleV1},{provide:n.AstVisitor,useClass:Y.AstVisitorV1},{provide:n.Events,useFactory:function(){return global.events}},{provide:n.Auto,useFactory:function(){return global.auto}},{provide:n.App,useFactory:function(){return global.app}},{provide:n.OCR_TYPE_TOKEN,useValue:"mlkit"},{provide:n.SETTING_TOKEN,useFactory:function(e){return e(n.Storage).get(n.SETTING_TOKEN)||n.defaultSetting}},{provide:O.Device,useClass:w.DeviceV1},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:p.GetCtxHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:d.GetXmlHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:y.GetHtmlHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:f.TakeScreenHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:B.GetJsonHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:h.UploadScriptHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:K.LogClearHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:_.RunScriptHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:M.RunCodeHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:J.LogShowHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:X.LogHideHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:v.ExitHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:A.GetCurrentAppInfoHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:H.VersionHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:V.FindImageAndClickHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:m.CallCtxHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:b.GoPageHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:S.GetpageHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:E.FindImageHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:j.FindImagesHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:P.TakeScreenGrayHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:I.TakeScreenThresholdHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:x.GetSimilarityHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:k.DeviceInfoHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:T.ClickHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:G.TakeScreenClipHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:R.StopHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:L.ResumeHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:W.DestoryHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:U.TaskAllHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:D.UploadMultiHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:N.RunElementHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:q.GetLogHandlerFactory},{provide:u.ON_WS_MESSAGE,multi:!0,useClass:z.SetVsCodeIdHandlerFactory},{provide:C.ImageUtil,useClass:F.ImageUtilV1},{provide:n.SET_UP_TOKEN,useValue:function(e){try{images.captureScreen()}catch(e){images.requestScreenCapture()}var t=e(O.Device);(e(n.Auto).waitFor(),(0,l.useToken)(n.DEVICE_ID).put(t.deviceId),console.setGlobalLogConfig({file:"/sdcard/Download/log.txt"}),(0,l.useToken)(n.DEV_DEBUGGER,!1).get())&&e.get(a.WebSocket).start();setInterval((function(){}),1e3)},multi:!0}])},2968:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleV1=void 0;var i=r(8217),c=r(6757),s=r(8079),l=r(2269),u=function(e){function ConsoleV1(){return null!==e&&e.apply(this,arguments)||this}return o(ConsoleV1,e),ConsoleV1.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e),this.send.apply(this,a(["log"],e,!1))},ConsoleV1.prototype.send=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];try{var n=(0,i.useInjector)().get(l.WebSocket),o=(0,s.useToken)(c.DEVICE_ID);n.send(JSON.stringify({success:!0,message:"log",data:{deviceId:o.get(),args:t,level:e}}))}catch(e){}},ConsoleV1.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,e),this.send.apply(this,a(["info"],e,!1))},ConsoleV1.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e),this.send.apply(this,a(["error"],e,!1))},ConsoleV1.prototype.clear=function(){return console.clear()},ConsoleV1.prototype.show=function(){return console.show()},ConsoleV1.prototype.hide=function(){return console.hide()},ConsoleV1}(c.Console);t.ConsoleV1=u},1771:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.CallCtxHandlerFactory=t.CallCtxHandler=void 0;var i=r(9575),c=r(4890),s=r(8217),l=r(6757),u=function(e){function CallCtxHandler(t){var r=e.call(this)||this;return r.__payload=t,r}return o(CallCtxHandler,e),Object.defineProperty(CallCtxHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),CallCtxHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t,r,n=(0,s.useInjector)().get(l.AstVisitor).root(e.data),o=null===(t=e.data)||void 0===t?void 0:t.m,i=null===(r=e.data)||void 0===r?void 0:r.args;if(o){var c=e.getProperty(o,n);if("function"==typeof c){if(Array.isArray(i)){var u=c.call.apply(c,a([e],i,!1));return void e.response({success:!0,message:"ok",data:u})}if(i){u=c.call(e,i);return void e.response({success:!0,message:"ok",data:u})}u=c.call(e);return void e.response({success:!0,message:"ok",data:u})}c?e.response({success:!0,message:"ok",data:c}):e.response({success:!1,message:"404"})}else e.response({success:!1,message:"m is missing"})}))},CallCtxHandler.prototype.getProperty=function(e,t){return e.split(".").reduce((function(e,t){return e&&Array.isArray(e)?e[parseInt(t)]:e&&"object"==typeof e?e[t]:void 0}),t)},CallCtxHandler.prototype.stop=function(){this.thread&&this.thread.interrupt()},CallCtxHandler.prototype.resume=function(){},CallCtxHandler.prototype.destory=function(){this.thread&&this.thread.interrupt()},CallCtxHandler.prototype.error=function(e){this.error(e)},CallCtxHandler}(c.CoreHandler);t.CallCtxHandler=u;var p=function(e){function CallCtxHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="callCtx",t}return o(CallCtxHandlerFactory,e),CallCtxHandlerFactory.prototype.create=function(e){return new u(e)},CallCtxHandlerFactory}(i.IHandlerFactory);t.CallCtxHandlerFactory=p},9182:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClickHandlerFactory=t.ClickHandler=void 0;var a=r(9575),i=function(e){function ClickHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(ClickHandler,e),Object.defineProperty(ClickHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),ClickHandler.prototype.start=function(){var e=this.payload.data,t=e.x||0,r=e.y||0,n=e.duration||150,o=press(t,r,n);return this.log("点击".concat(t,",").concat(r,",").concat(n,"=").concat(o)),this.response({success:!0,message:"ok",data:o})},ClickHandler.prototype.stop=function(){},ClickHandler.prototype.resume=function(){},ClickHandler.prototype.destory=function(){},ClickHandler.prototype.error=function(e){console.error("get ctx error",e)},ClickHandler}(r(4890).CoreHandler);t.ClickHandler=i;var c=function(e){function ClickHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="click",t}return o(ClickHandlerFactory,e),ClickHandlerFactory.prototype.create=function(e){return new i(e)},ClickHandlerFactory}(a.IHandlerFactory);t.ClickHandlerFactory=c},2134:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.DestoryHandlerFactory=t.DestoryHandler=void 0;var a=r(9575),i=function(e){function DestoryHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(DestoryHandler,e),Object.defineProperty(DestoryHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),DestoryHandler.prototype.start=function(){if(this.data)if(this.data.id){var e=(0,a.getHandlerById)(this.data.id);e?((0,a.destoryHandler)(e),this.response({success:!0,message:"ok",data:{id:e.id}})):this.response({success:!1,message:"没有找到任务"})}else this.response({success:!1,message:"任务id缺失"});else this.response({success:!1,message:"数据缺失"})},DestoryHandler.prototype.stop=function(){},DestoryHandler.prototype.resume=function(){},DestoryHandler.prototype.destory=function(){},DestoryHandler.prototype.error=function(e){this.log(e)},DestoryHandler}(r(4890).CoreHandler);t.DestoryHandler=i;var c=function(e){function DestoryHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="destory",t}return o(DestoryHandlerFactory,e),DestoryHandlerFactory.prototype.create=function(e){return new i(e)},DestoryHandlerFactory}(a.IHandlerFactory);t.DestoryHandlerFactory=c},8842:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceInfoHandlerFactory=t.DeviceInfoHandler=void 0;var a=r(9575),i=function(e){function DeviceInfoHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(DeviceInfoHandler,e),Object.defineProperty(DeviceInfoHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),DeviceInfoHandler.prototype.start=function(){var e=context.getResources().getConfiguration().orientation,t=device.width,r=device.height;return t>r&&(e=1===e?2:1),this.response({width:t,height:r,orientation:e})},DeviceInfoHandler.prototype.stop=function(){},DeviceInfoHandler.prototype.resume=function(){},DeviceInfoHandler.prototype.destory=function(){},DeviceInfoHandler.prototype.error=function(e){},DeviceInfoHandler}(r(4890).CoreHandler);t.DeviceInfoHandler=i;var c=function(e){function DeviceInfoHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="deviceInfo",t}return o(DeviceInfoHandlerFactory,e),DeviceInfoHandlerFactory.prototype.create=function(e){return new i(e)},DeviceInfoHandlerFactory}(a.IHandlerFactory);t.DeviceInfoHandlerFactory=c},8656:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.ExitHandlerFactory=t.ExitHandler=void 0;var a=r(2269),i=r(9575),c=r(8217),s=function(e){function ExitHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(ExitHandler,e),Object.defineProperty(ExitHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),ExitHandler.prototype.start=function(){var e=(0,c.useInjector)()(a.WebSocket);e.response(this.payload,{success:!0}),e.destory(),exit()},ExitHandler.prototype.stop=function(){},ExitHandler.prototype.resume=function(){},ExitHandler.prototype.destory=function(){},ExitHandler.prototype.error=function(e){},ExitHandler}(r(4890).CoreHandler);t.ExitHandler=s;var l=function(e){function ExitHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="exit",t}return o(ExitHandlerFactory,e),ExitHandlerFactory.prototype.create=function(e){return new s(e)},ExitHandlerFactory}(i.IHandlerFactory);t.ExitHandlerFactory=l},5486:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.FindImageHandlerFactory=t.FindImageHandler=void 0;var i=r(9575),c=r(4890),s=r(8217),l=r(8368),u=function(e){function FindImageHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(FindImageHandler,e),Object.defineProperty(FindImageHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),FindImageHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=e.payload.data,r=t.url,n=t.type,o=t.data,i=a(t,["url","type","data"]),c=(0,s.useInjector)().get(l.ImageUtil),u=null;if(u="base64"===n?images.fromBase64(o):images.load(r)){var p=c.nextImage();if(!p)return u.recycle(),void e.response({success:!1,message:"截图失败"});var d=images.findImage(p,u,i);p.recycle(),u.recycle(),d?e.response({success:!0,message:"ok",data:{x:d.x,y:d.y}}):e.response({success:!1,message:"没有找到图片"})}else e.response({success:!1,message:"目标图片加载失败: ".concat(n),data:e.payload.data})}))},FindImageHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImageHandler.prototype.resume=function(){},FindImageHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImageHandler.prototype.error=function(e){console.error("get ctx error",e)},FindImageHandler}(c.CoreHandler);t.FindImageHandler=u;var p=function(e){function FindImageHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="findImage",t}return o(FindImageHandlerFactory,e),FindImageHandlerFactory.prototype.create=function(e){return new u(e)},FindImageHandlerFactory}(i.IHandlerFactory);t.FindImageHandlerFactory=p},4993:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.FindImageAndClickHandlerFactory=t.FindImageAndClickHandler=void 0;var i=r(9575),c=r(4890),s=r(8217),l=r(8368),u=function(e){function FindImageAndClickHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(FindImageAndClickHandler,e),Object.defineProperty(FindImageAndClickHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),FindImageAndClickHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=e.payload.data,r=t.url,n=t.type,o=t.data,i=a(t,["url","type","data"]),c=(0,s.useInjector)().get(l.ImageUtil),u=null;if(u="base64"===n?images.fromBase64(o):images.load(r)){var p=c.nextImage();if(!p)return u.recycle(),void e.response({success:!1,message:"截图失败"});var d=images.findImage(p,u,i);if(p.recycle(),u.recycle(),d){var y=click(d.x,d.y);e.response({success:!0,message:"ok",data:{x:d.x,y:d.y,click:y}})}else e.response({success:!1,message:"没有找到图片"})}else e.response({success:!1,message:"目标图片加载失败: ".concat(n),data:e.payload.data})}))},FindImageAndClickHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImageAndClickHandler.prototype.resume=function(){},FindImageAndClickHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImageAndClickHandler.prototype.error=function(e){console.error("get ctx error",e)},FindImageAndClickHandler}(c.CoreHandler);t.FindImageAndClickHandler=u;var p=function(e){function FindImageAndClickHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="findImageAndClick",t}return o(FindImageAndClickHandlerFactory,e),FindImageAndClickHandlerFactory.prototype.create=function(e){return new u(e)},FindImageAndClickHandlerFactory}(i.IHandlerFactory);t.FindImageAndClickHandlerFactory=p},3605:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.FindImagesHandlerFactory=t.FindImagesHandler=void 0;var i=r(9575),c=r(4890),s=r(8217),l=r(8368),u=function(e){function FindImagesHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(FindImagesHandler,e),Object.defineProperty(FindImagesHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),FindImagesHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=e.payload.data,r=t.url,n=a(t,["url"]),o=(0,s.useInjector)().get(l.ImageUtil),i=images.load(r);if(i){var c=o.nextImage();if(!c)return i.recycle(),void e.response({success:!1,message:"截图失败"});var u=images.matchTemplate(c,i,n);c.recycle(),i.recycle(),u&&u.matches?e.response({success:!0,message:"ok",data:u.matches.map((function(e){return{x:e.point.x,y:e.point.y,similarity:e.similarity}}))}):e.response({success:!1,message:"没有匹配到目标图片"})}else e.response({success:!1,message:"目标图片加载失败: ".concat(r),data:e.payload.data})}))},FindImagesHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImagesHandler.prototype.resume=function(){},FindImagesHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},FindImagesHandler.prototype.error=function(e){console.error("get ctx error",e)},FindImagesHandler}(c.CoreHandler);t.FindImagesHandler=u;var p=function(e){function FindImagesHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="findImages",t}return o(FindImagesHandlerFactory,e),FindImagesHandlerFactory.prototype.create=function(e){return new u(e)},FindImagesHandlerFactory}(i.IHandlerFactory);t.FindImagesHandlerFactory=p},1561:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetCtxHandlerFactory=t.GetCtxHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(6757),l=r(2269),u=function(e){function GetCtxHandler(t){var r=e.call(this)||this;return r.__payload=t,r}return o(GetCtxHandler,e),Object.defineProperty(GetCtxHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetCtxHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=(0,c.useInjector)().get(s.AstVisitor),r=t.root(e.payload.data||{});r.__keys=Object.keys(r);var n=t.toJson(r),o=(0,c.useInjector)().get(l.WebSocket);n?o.response(e.payload,JSON.parse(n)):o.response(e.payload,{success:!1})}))},GetCtxHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetCtxHandler.prototype.resume=function(){},GetCtxHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetCtxHandler.prototype.error=function(e){console.error("get ctx error",e)},GetCtxHandler}(i.CoreHandler);t.GetCtxHandler=u;var p=function(e){function GetCtxHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getCtx",t}return o(GetCtxHandlerFactory,e),GetCtxHandlerFactory.prototype.create=function(e){return new u(e)},GetCtxHandlerFactory}(a.IHandlerFactory);t.GetCtxHandlerFactory=p},1890:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetCurrentAppInfoHandlerFactory=t.GetCurrentAppInfoHandler=void 0;var a=r(9575),i=function(e){function GetCurrentAppInfoHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetCurrentAppInfoHandler,e),Object.defineProperty(GetCurrentAppInfoHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetCurrentAppInfoHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=selector().findOne(3e3);if(!t)return e.response({success:!1,message:"无障碍未开启"});var r=t.packageName();if(!r)return e.response({success:!1,message:"当前packageName为空"});for(var n=context.getPackageManager(),o=n.getInstalledApplications(0),a={},i=0;i<o.size();i++){var c=o.get(i),s=c.loadLabel(n).toString(),l=c.packageName,u=c.versionName;if(r===l){a.appName=s,a.packageName=l,a.appVersion=u;var p=c.loadIcon(n),d=null;if(p&&p.getBitmap)d=p.getBitmap();else if(p&&p.getBackground){var y=p.getForeground(),f=p.getBackground(),h=e.drawableToBitmap(y),_=e.drawableToBitmap(f);if(h&&_){d=android.graphics.Bitmap.createBitmap(e.getWidth(h.getWidth()),e.getWidth(h.getHeight()),android.graphics.Bitmap.Config.ARGB_8888);var g=new android.graphics.Canvas(d);g.drawBitmap(_,0,0,null),g.drawBitmap(h,0,0,null),h.recycle(),_.recycle()}}if(!d)continue;var v=new java.io.ByteArrayOutputStream;d.compress(android.graphics.Bitmap.CompressFormat.PNG,100,v);var H=images.fromBytes(v.toByteArray());a.appIcon=images.toBase64(H,"png",e.payload.p||100),H.recycle()}}return e.response(a)}))},GetCurrentAppInfoHandler.prototype.getWidth=function(e){return e>0?e:126},GetCurrentAppInfoHandler.prototype.drawableToBitmap=function(e){if(null==e)return null;var t=android.graphics.Bitmap.createBitmap(this.getWidth(e.getIntrinsicWidth()),this.getWidth(e.getIntrinsicHeight()),android.graphics.Bitmap.Config.ARGB_8888),r=new android.graphics.Canvas(t);return e.setBounds(0,0,r.getWidth(),r.getHeight()),e.draw(r),t},GetCurrentAppInfoHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetCurrentAppInfoHandler.prototype.resume=function(){},GetCurrentAppInfoHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetCurrentAppInfoHandler.prototype.error=function(e){},GetCurrentAppInfoHandler}(r(4890).CoreHandler);t.GetCurrentAppInfoHandler=i;var c=function(e){function GetCurrentAppInfoHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="currentAppInfo",t}return o(GetCurrentAppInfoHandlerFactory,e),GetCurrentAppInfoHandlerFactory.prototype.create=function(e){return new i(e)},GetCurrentAppInfoHandlerFactory}(a.IHandlerFactory);t.GetCurrentAppInfoHandlerFactory=c},7799:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetHtmlHandlerFactory=t.GetHtmlHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(6757),l=r(8079),u=r(2269),p=r(4e3),d=function(e){function GetHtmlHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetHtmlHandler,e),Object.defineProperty(GetHtmlHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetHtmlHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=selector().findOne(3e3),r=(0,c.useInjector)().get(u.WebSocket),n=(0,l.useToken)(s.DEVICE_ID);if(t){var o=(0,p.astToHtml)(t);if(!o)return void r.response(e.payload,{success:!1,message:"ast to html fail"});var a=context.getResources().getConfiguration().orientation,i=device.width,d=device.height;if(i>d&&(a=1===a?2:1),1===a){var y='<html><head><style>*{margin: 0px;padding:0px;}</style></head><body style="position:relative;width:'.concat(i,"px;height:").concat(d,'px;overflow:hidden;"><img style="position:absolute;top:0px;left:0px;width:').concat(i,"px;height:").concat(d,'px;" src="http://43.240.223.138:3001/rpc/v1/').concat(n.get(),'/takeScreen"/>').concat(o,"</body></html>");r.response(e.payload,y,"text/html; charset=utf-8")}else{y='<html><head><style>*{margin: 0px;padding:0px;}</style></head><body style="position:relative;width:'.concat(d,"px;height:").concat(i,'px;overflow:hidden;"><img style="position:absolute;top:0px;left:0px;width:').concat(d,"px;height:").concat(i,'px;" src="http://43.240.223.138:3001/rpc/v1/').concat(n.get(),'/takeScreen"/>').concat(o,"</body></html>");r.response(e.payload,y,"text/html; charset=utf-8")}}else r.response(e.payload,{success:!1,message:"请检查无障碍模式是否正藏开启"})}))},GetHtmlHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetHtmlHandler.prototype.resume=function(){},GetHtmlHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetHtmlHandler.prototype.error=function(e){this.log(e)},GetHtmlHandler}(i.CoreHandler);t.GetHtmlHandler=d;var y=function(e){function GetHtmlHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getHtml",t}return o(GetHtmlHandlerFactory,e),GetHtmlHandlerFactory.prototype.create=function(e){return new d(e)},GetHtmlHandlerFactory}(a.IHandlerFactory);t.GetHtmlHandlerFactory=y},9768:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetJsonHandlerFactory=t.GetJsonHandler=void 0;var a=r(9575),i=r(4890),c=r(4e3),s=function(e){function GetJsonHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetJsonHandler,e),Object.defineProperty(GetJsonHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetJsonHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=selector().findOne(3e3);if(t){var r=(0,c.astToJson)(t);return r?void e.response(r):void e.response({success:!1,message:"ast to json fail"})}e.response({success:!1,message:"请检查无障碍模式是否正藏开启"})}))},GetJsonHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetJsonHandler.prototype.resume=function(){},GetJsonHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetJsonHandler.prototype.error=function(e){this.log(e)},GetJsonHandler}(i.CoreHandler);t.GetJsonHandler=s;var l=function(e){function GetJsonHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getJson",t}return o(GetJsonHandlerFactory,e),GetJsonHandlerFactory.prototype.create=function(e){return new s(e)},GetJsonHandlerFactory}(a.IHandlerFactory);t.GetJsonHandlerFactory=l},3706:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetLogHandlerFactory=t.GetLogHandler=void 0;var a=r(9575),i=function(e){function GetLogHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetLogHandler,e),Object.defineProperty(GetLogHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetLogHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=files.read("/sdcard/Download/log.txt","utf-8");e.response({success:!0,data:t,message:"ok"})}))},GetLogHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetLogHandler.prototype.resume=function(){},GetLogHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetLogHandler.prototype.error=function(e){this.log(e)},GetLogHandler}(r(4890).CoreHandler);t.GetLogHandler=i;var c=function(e){function GetLogHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getLog",t}return o(GetLogHandlerFactory,e),GetLogHandlerFactory.prototype.create=function(e){return new i(e)},GetLogHandlerFactory}(a.IHandlerFactory);t.GetLogHandlerFactory=c},961:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetpageHandlerFactory=t.GetPageHandler=void 0;var a=r(9575),i=r(4890),c=r(7750),s=function(e){function GetPageHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetPageHandler,e),Object.defineProperty(GetPageHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetPageHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=Date.now();(0,c.initSettingFromCloud)(e.payload.data.appId);var r=(0,c.getCurrentPage)();r&&r.name?e.response({page:r.name,useTime:Date.now()-t}):e.response({success:!1,useTime:Date.now()-t})}))},GetPageHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetPageHandler.prototype.resume=function(){},GetPageHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetPageHandler.prototype.error=function(e){this.log(e)},GetPageHandler}(i.CoreHandler);t.GetPageHandler=s;var l=function(e){function GetpageHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getPage",t}return o(GetpageHandlerFactory,e),GetpageHandlerFactory.prototype.create=function(e){return new s(e)},GetpageHandlerFactory}(a.IHandlerFactory);t.GetpageHandlerFactory=l},105:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetSimilarityHandlerFactory=t.GetSimilarityHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(8368),l=function(e){function GetSimilarityHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetSimilarityHandler,e),Object.defineProperty(GetSimilarityHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetSimilarityHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){try{var t=e.payload.data.url,r=(0,c.useInjector)().get(s.ImageUtil),n=images.load(t);if(!n)return void e.response({success:!1,message:"目标图片加载失败: ".concat(t),data:e.payload.data});var o=r.nextImage();if(!o)return n.recycle(),void e.response({success:!1,message:"截图失败",data:e.payload.data});var a=images.getSimilarity(o,n);return o.recycle(),n.recycle(),e.response({success:!0,message:"ok",data:{similarity:a}})}catch(t){return e.response({success:!1,message:"error",data:t.toString()})}}))},GetSimilarityHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetSimilarityHandler.prototype.resume=function(){},GetSimilarityHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetSimilarityHandler.prototype.error=function(e){this.log(e)},GetSimilarityHandler}(i.CoreHandler);t.GetSimilarityHandler=l;var u=function(e){function GetSimilarityHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getSimilarity",t}return o(GetSimilarityHandlerFactory,e),GetSimilarityHandlerFactory.prototype.create=function(e){return new l(e)},GetSimilarityHandlerFactory}(a.IHandlerFactory);t.GetSimilarityHandlerFactory=u},5049:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GetXmlHandlerFactory=t.GetXmlHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(2269),l=r(4e3),u=function(e){function GetXmlHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GetXmlHandler,e),Object.defineProperty(GetXmlHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GetXmlHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=selector().findOne(3e3),r=(0,c.useInjector)().get(s.WebSocket);if(t){var n=(0,l.astToXml)(t);if(!n)return void r.response(e.payload,{success:!1,message:"ast to xml fail"});r.response(e.payload,n,"text/xml; charset=utf-8")}else r.response(e.payload,{success:!1,message:"请检查无障碍模式是否正藏开启"})}))},GetXmlHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetXmlHandler.prototype.resume=function(){},GetXmlHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GetXmlHandler.prototype.error=function(e){this.log(e)},GetXmlHandler}(i.CoreHandler);t.GetXmlHandler=u;var p=function(e){function GetXmlHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="getXml",t}return o(GetXmlHandlerFactory,e),GetXmlHandlerFactory.prototype.create=function(e){return new u(e)},GetXmlHandlerFactory}(a.IHandlerFactory);t.GetXmlHandlerFactory=p},9557:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.GoPageHandlerFactory=t.GoPageHandler=void 0;var a=r(9575),i=r(4890),c=r(7750),s=function(e){function GoPageHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(GoPageHandler,e),Object.defineProperty(GoPageHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),GoPageHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t,r=null===(t=e.data)||void 0===t?void 0:t.page;if(r){var n=Date.now();(0,c.initSettingFromCloud)(e.payload.data.appId);var o=(0,c.navigationPage)(r);if(!o)return e.response({success:!1,message:"跳转失败",useTime:Date.now()-n});e.response({success:o.name===e.payload.data.page,data:{page:o.name},useTime:Date.now()-n})}else e.response({success:!1,message:"page 必填"})}))},GoPageHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GoPageHandler.prototype.resume=function(){},GoPageHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},GoPageHandler.prototype.error=function(e){this.log(e)},GoPageHandler}(i.CoreHandler);t.GoPageHandler=s;var l=function(e){function GoPageHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="goPage",t}return o(GoPageHandlerFactory,e),GoPageHandlerFactory.prototype.create=function(e){return new s(e)},GoPageHandlerFactory}(a.IHandlerFactory);t.GoPageHandlerFactory=l},9123:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.LogClearHandlerFactory=t.LogClearHandler=void 0;var a=r(2269),i=r(9575),c=r(8217),s=function(e){function LogClearHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(LogClearHandler,e),Object.defineProperty(LogClearHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),LogClearHandler.prototype.start=function(){var e=(0,c.useInjector)()(a.WebSocket);console.clear(),e.response(this.payload,{success:!0})},LogClearHandler.prototype.stop=function(){},LogClearHandler.prototype.resume=function(){},LogClearHandler.prototype.destory=function(){},LogClearHandler.prototype.error=function(e){},LogClearHandler}(r(4890).CoreHandler);t.LogClearHandler=s;var l=function(e){function LogClearHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="logClear",t}return o(LogClearHandlerFactory,e),LogClearHandlerFactory.prototype.create=function(e){return new s(e)},LogClearHandlerFactory}(i.IHandlerFactory);t.LogClearHandlerFactory=l},5504:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.LogHideHandlerFactory=t.LogHideHandler=void 0;var a=r(2269),i=r(9575),c=r(8217),s=function(e){function LogHideHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(LogHideHandler,e),Object.defineProperty(LogHideHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),LogHideHandler.prototype.start=function(){var e=(0,c.useInjector)()(a.WebSocket);console.hide(),e.response(this.payload,{success:!0})},LogHideHandler.prototype.stop=function(){},LogHideHandler.prototype.resume=function(){},LogHideHandler.prototype.destory=function(){},LogHideHandler.prototype.error=function(e){},LogHideHandler}(r(4890).CoreHandler);t.LogHideHandler=s;var l=function(e){function LogHideHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="logHide",t}return o(LogHideHandlerFactory,e),LogHideHandlerFactory.prototype.create=function(e){return new s(e)},LogHideHandlerFactory}(i.IHandlerFactory);t.LogHideHandlerFactory=l},2601:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.LogShowHandlerFactory=t.LogShowHandler=void 0;var a=r(2269),i=r(9575),c=r(8217),s=function(e){function LogShowHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(LogShowHandler,e),Object.defineProperty(LogShowHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),LogShowHandler.prototype.start=function(){var e=(0,c.useInjector)()(a.WebSocket);console.show(),e.response(this.payload,{success:!0})},LogShowHandler.prototype.stop=function(){},LogShowHandler.prototype.resume=function(){},LogShowHandler.prototype.destory=function(){},LogShowHandler.prototype.error=function(e){},LogShowHandler}(r(4890).CoreHandler);t.LogShowHandler=s;var l=function(e){function LogShowHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="logShow",t}return o(LogShowHandlerFactory,e),LogShowHandlerFactory.prototype.create=function(e){return new s(e)},LogShowHandlerFactory}(i.IHandlerFactory);t.LogShowHandlerFactory=l},975:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.ResumeHandlerFactory=t.ResumeHandler=void 0;var a=r(9575),i=function(e){function ResumeHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(ResumeHandler,e),Object.defineProperty(ResumeHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),ResumeHandler.prototype.start=function(){if(this.data)if(this.data.id){var e=(0,a.getHandlerById)(this.data.id);e?((0,a.resumeHandler)(e),this.response({success:!0,message:"ok",data:{id:e.id}})):this.response({success:!1,message:"没有找到任务"})}else this.response({success:!1,message:"任务id缺失"});else this.response({success:!1,message:"数据缺失"})},ResumeHandler.prototype.stop=function(){},ResumeHandler.prototype.resume=function(){},ResumeHandler.prototype.destory=function(){},ResumeHandler.prototype.error=function(e){this.log(e)},ResumeHandler}(r(4890).CoreHandler);t.ResumeHandler=i;var c=function(e){function ResumeHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="resume",t}return o(ResumeHandlerFactory,e),ResumeHandlerFactory.prototype.create=function(e){return new i(e)},ResumeHandlerFactory}(a.IHandlerFactory);t.ResumeHandlerFactory=c},1938:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.RunCodeHandlerFactory=t.RunCodeHandler=void 0;var a=r(9575),i=function(e){function RunCodeHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="task",r}return o(RunCodeHandler,e),Object.defineProperty(RunCodeHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),RunCodeHandler.prototype.start=function(){this.data||this.response({success:!1,message:"数据缺失"}),this.data.name||this.response({success:!1,message:"脚本名缺失"}),this.data.code||this.response({success:!1,message:"脚本内容缺失"}),this.eng=engines.execScript(this.data.name,decodeURIComponent(this.data.code),this.data.options||{}),this.response({success:!0,message:"ok",data:this.data.name})},RunCodeHandler.prototype.stop=function(){var e=this.eng.getEngine();e&&e.emit("stop")},RunCodeHandler.prototype.resume=function(){var e=this.eng.getEngine();e&&e.emit("resume")},RunCodeHandler.prototype.destory=function(){var e=this.eng.getEngine();e&&e.forceStop()},RunCodeHandler.prototype.error=function(e){this.log(e)},RunCodeHandler}(r(4890).CoreHandler);t.RunCodeHandler=i;var c=function(e){function RunCodeHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="runCode",t}return o(RunCodeHandlerFactory,e),RunCodeHandlerFactory.prototype.create=function(e){return new i(e)},RunCodeHandlerFactory}(a.IHandlerFactory);t.RunCodeHandlerFactory=c},4771:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.RunElementHandlerFactory=t.RunElementHandler=void 0;var a=r(9575),i=r(4890),c=r(7750),s=function(e){function RunElementHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(RunElementHandler,e),Object.defineProperty(RunElementHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),RunElementHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){if(e.data)if(e.data.app_id)if(e.data.id){var t=(0,c.getElementById)(e.data.app_id,e.data.id);if(t){var r=(0,c.runElement)(t);e.response({success:!0,message:"ok",data:{result:r,id:e.id}})}else e.response({success:!1,message:"没有找到element"})}else e.response({success:!1,message:"app_id缺失"});else e.response({success:!1,message:"id缺失"});else e.response({success:!1,message:"数据缺失"})}))},RunElementHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},RunElementHandler.prototype.resume=function(){},RunElementHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},RunElementHandler.prototype.error=function(e){this.log(e)},RunElementHandler}(i.CoreHandler);t.RunElementHandler=s;var l=function(e){function RunElementHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="runElement",t}return o(RunElementHandlerFactory,e),RunElementHandlerFactory.prototype.create=function(e){return new s(e)},RunElementHandlerFactory}(a.IHandlerFactory);t.RunElementHandlerFactory=l},340:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.RunScriptHandlerFactory=t.RunScriptHandler=void 0;var a=r(9575),i=function(e){function RunScriptHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="task",r}return o(RunScriptHandler,e),Object.defineProperty(RunScriptHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),RunScriptHandler.prototype.start=function(){var e=this.data.path;this.eng=engines.execScriptFile(e),this.response({success:!0,message:"ok",data:{id:this.id}})},RunScriptHandler.prototype.stop=function(){var e=this.eng.getEngine();e&&e.emit("stop")},RunScriptHandler.prototype.resume=function(){var e=this.eng.getEngine();e&&e.emit("resume")},RunScriptHandler.prototype.destory=function(){var e=this.eng.getEngine();e&&e.forceStop()},RunScriptHandler.prototype.error=function(e){this.log(e)},RunScriptHandler}(r(4890).CoreHandler);t.RunScriptHandler=i;var c=function(e){function RunScriptHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="runScript",t}return o(RunScriptHandlerFactory,e),RunScriptHandlerFactory.prototype.create=function(e){return new i(e)},RunScriptHandlerFactory}(a.IHandlerFactory);t.RunScriptHandlerFactory=c},8877:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.SetVsCodeIdHandlerFactory=t.SetVsCodeIdHandler=void 0;var a=r(2269),i=r(9575),c=r(8217),s=r(4890),l=r(8079),u=r(6757),p=function(e){function SetVsCodeIdHandler(t,r){var n=e.call(this)||this;return n.__payload=t,n.category="task",n.name=r,n}return o(SetVsCodeIdHandler,e),Object.defineProperty(SetVsCodeIdHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),SetVsCodeIdHandler.prototype.start=function(){var e,t=(0,c.useInjector)()(a.WebSocket),r=null===(e=this.payload.data)||void 0===e?void 0:e.uuid;r?((0,l.useToken)(u.VSCODE_ID).put(r),this.thread=threads.start((function(){for(;;)try{var e=files.read("/sdcard/Download/log.txt","utf-8");http.postJson("http://43.240.223.138:3001/rpc/vscode/".concat(r,"/putLog"),{content:e}),sleep(1e3)}catch(e){break}})),t.response(this.payload,{success:!0})):this.response({success:!1,message:"uuid必填"})},SetVsCodeIdHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},SetVsCodeIdHandler.prototype.resume=function(){},SetVsCodeIdHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},SetVsCodeIdHandler.prototype.error=function(e){this.log(e)},SetVsCodeIdHandler}(s.CoreHandler);t.SetVsCodeIdHandler=p;var d=function(e){function SetVsCodeIdHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="setVsCodeId",t}return o(SetVsCodeIdHandlerFactory,e),SetVsCodeIdHandlerFactory.prototype.create=function(e){return this.instance||(this.instance=new p(e,this.action)),this.instance},SetVsCodeIdHandlerFactory}(i.IHandlerFactory);t.SetVsCodeIdHandlerFactory=d},4472:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.StopHandlerFactory=t.StopHandler=void 0;var a=r(9575),i=function(e){function StopHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(StopHandler,e),Object.defineProperty(StopHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),StopHandler.prototype.start=function(){if(this.data)if(this.data.id){var e=(0,a.getHandlerById)(this.data.id);e?((0,a.stopHandler)(e),this.response({success:!0,message:"ok",data:{id:e.id}})):this.response({success:!1,message:"没有找到任务"})}else this.response({success:!1,message:"任务id缺失"});else this.response({success:!1,message:"数据缺失"})},StopHandler.prototype.stop=function(){},StopHandler.prototype.resume=function(){},StopHandler.prototype.destory=function(){},StopHandler.prototype.error=function(e){this.log(e)},StopHandler}(r(4890).CoreHandler);t.StopHandler=i;var c=function(e){function StopHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="stop",t}return o(StopHandlerFactory,e),StopHandlerFactory.prototype.create=function(e){return new i(e)},StopHandlerFactory}(a.IHandlerFactory);t.StopHandlerFactory=c},9163:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.TakeScreenHandlerFactory=t.TakeScreenHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(8368),l=r(2269),u=function(e){function TakeScreenHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(TakeScreenHandler,e),Object.defineProperty(TakeScreenHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),TakeScreenHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t,r=(0,c.useInjector)().get(l.WebSocket),n=(0,c.useInjector)().get(s.ImageUtil).nextImage();if(n){var o=images.toBytes(n,"jpeg",(null===(t=e.payload.data)||void 0===t?void 0:t.p)||100);n.recycle(),r.response(e.payload,o,"image/jpeg")}else r.response(e.payload,{success:!1,message:"获取截图失败"})}))},TakeScreenHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenHandler.prototype.resume=function(){},TakeScreenHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenHandler.prototype.error=function(e){this.log(e)},TakeScreenHandler}(i.CoreHandler);t.TakeScreenHandler=u;var p=function(e){function TakeScreenHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="takeScreen",t}return o(TakeScreenHandlerFactory,e),TakeScreenHandlerFactory.prototype.create=function(e){return new u(e)},TakeScreenHandlerFactory}(a.IHandlerFactory);t.TakeScreenHandlerFactory=p},3341:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.TakeScreenClipHandlerFactory=t.TakeScreenClipHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(8368),l=r(2269),u=function(e){function TakeScreenClipHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(TakeScreenClipHandler,e),Object.defineProperty(TakeScreenClipHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),TakeScreenClipHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=(0,c.useInjector)().get(l.WebSocket),r=(0,c.useInjector)().get(s.ImageUtil).nextImage();if(r){var n=e.payload.data,o=parseInt("".concat(n.x||0)),a=parseInt("".concat(n.y||0)),i=parseInt("".concat(n.x1||0)),u=parseInt("".concat(n.y1||0));if("base64"===n.type){var p=images.clip(r,o,a,i-o,u-a),d=images.toBase64(p,"jpeg",e.payload.p||100);return e.recyle(r),e.recyle(p),void e.response({data:d,message:"ok",success:!0})}var y=images.clip(r,o,a,i-o,u-a),f=images.toBytes(y,"jpeg",e.payload.p||100);e.recyle(r),e.recyle(y),e.response(f,"image/jpeg")}else t.response(e.payload,{success:!1,message:"获取截图失败"})}))},TakeScreenClipHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenClipHandler.prototype.resume=function(){},TakeScreenClipHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenClipHandler.prototype.error=function(e){this.log(e)},TakeScreenClipHandler}(i.CoreHandler);t.TakeScreenClipHandler=u;var p=function(e){function TakeScreenClipHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="takeScreenClip",t}return o(TakeScreenClipHandlerFactory,e),TakeScreenClipHandlerFactory.prototype.create=function(e){return new u(e)},TakeScreenClipHandlerFactory}(a.IHandlerFactory);t.TakeScreenClipHandlerFactory=p},5816:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.TakeScreenGrayHandlerFactory=t.TakeScreenGrayHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(8368),l=function(e){function TakeScreenGrayHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(TakeScreenGrayHandler,e),Object.defineProperty(TakeScreenGrayHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),TakeScreenGrayHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){try{var t=(0,c.useInjector)().get(s.ImageUtil).nextImage();if(!t)return void e.response({success:!1,message:"获取截图失败"});var r=images.grayscale(t);if(!r)return t.recycle(),void e.response({success:!1,message:"图片灰度化失败"});var n=images.toBytes(r,"jpeg",e.payload.p||100);r.recycle(),t.recycle(),e.response(n,"image/jpeg")}catch(t){e.response({success:!1,message:"error",data:t})}}))},TakeScreenGrayHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenGrayHandler.prototype.resume=function(){},TakeScreenGrayHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenGrayHandler.prototype.error=function(e){this.log(e)},TakeScreenGrayHandler}(i.CoreHandler);t.TakeScreenGrayHandler=l;var u=function(e){function TakeScreenGrayHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="takeScreenGray",t}return o(TakeScreenGrayHandlerFactory,e),TakeScreenGrayHandlerFactory.prototype.create=function(e){return new l(e)},TakeScreenGrayHandlerFactory}(a.IHandlerFactory);t.TakeScreenGrayHandlerFactory=u},692:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.TakeScreenThresholdHandlerFactory=t.TakeScreenThresholdHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(8368),l=function(e){function TakeScreenThresholdHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(TakeScreenThresholdHandler,e),Object.defineProperty(TakeScreenThresholdHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),TakeScreenThresholdHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){try{var t=(0,c.useInjector)().get(s.ImageUtil).nextImage();if(!t)return void e.response({success:!1,message:"获取截图失败"});var r=e.payload.data,n=parseInt("".concat(r.threshold||100)),o=parseInt("".concat(r.maxVal||255)),a=r.type||"BINARY",i=images.threshold(t,n,o,a);if(!i)return t.recycle(),void e.response({success:!1,message:"图片灰度化失败"});var l=images.toBytes(i,"jpeg",e.payload.p||100);i.recycle(),t.recycle(),e.response(l,"image/jpeg")}catch(t){e.response({success:!1,message:"error",data:t})}}))},TakeScreenThresholdHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenThresholdHandler.prototype.resume=function(){},TakeScreenThresholdHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},TakeScreenThresholdHandler.prototype.error=function(e){this.log(e)},TakeScreenThresholdHandler}(i.CoreHandler);t.TakeScreenThresholdHandler=l;var u=function(e){function TakeScreenThresholdHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="takeScreenThreshold",t}return o(TakeScreenThresholdHandlerFactory,e),TakeScreenThresholdHandlerFactory.prototype.create=function(e){return new l(e)},TakeScreenThresholdHandlerFactory}(a.IHandlerFactory);t.TakeScreenThresholdHandlerFactory=u},234:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.TaskAllHandlerFactory=t.TaskAllHandler=void 0;var a=r(9575),i=function(e){function TaskAllHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(TaskAllHandler,e),Object.defineProperty(TaskAllHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),TaskAllHandler.prototype.start=function(){var e=(0,a.getAllHandler)();this.response({success:!0,message:"ok",data:e.map((function(e){return{id:e.id,status:e.status,category:e.category}}))})},TaskAllHandler.prototype.stop=function(){},TaskAllHandler.prototype.resume=function(){},TaskAllHandler.prototype.destory=function(){},TaskAllHandler.prototype.error=function(e){this.log(e)},TaskAllHandler}(r(4890).CoreHandler);t.TaskAllHandler=i;var c=function(e){function TaskAllHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="taskAll",t}return o(TaskAllHandlerFactory,e),TaskAllHandlerFactory.prototype.create=function(e){return new i(e)},TaskAllHandlerFactory}(a.IHandlerFactory);t.TaskAllHandlerFactory=c},5820:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.UploadMultiHandlerFactory=t.UploadMultiHandler=void 0;var a=r(9575),i=function(e){function UploadMultiHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(UploadMultiHandler,e),Object.defineProperty(UploadMultiHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),UploadMultiHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){return e.payload.data?Array.isArray(e.payload.data)?(Object.keys(e.payload.data).map((function(t){var r=e.payload.data[t];e.writeFileSync(r.path,r.content)})),e.response({success:!0,message:"upload success"})):e.response({success:!1,message:"data not array"}):e.response({success:!1,message:"data need provider"})}))},UploadMultiHandler.prototype.writeFileSync=function(e,t){var r=e.split("/");r.pop();var n=r.join("/");files.ensureDir(n),files.write(e,t)},UploadMultiHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},UploadMultiHandler.prototype.resume=function(){},UploadMultiHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},UploadMultiHandler.prototype.error=function(e){this.log(e)},UploadMultiHandler}(r(4890).CoreHandler);t.UploadMultiHandler=i;var c=function(e){function UploadMultiHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="uploadMulti",t}return o(UploadMultiHandlerFactory,e),UploadMultiHandlerFactory.prototype.create=function(e){return new i(e)},UploadMultiHandlerFactory}(a.IHandlerFactory);t.UploadMultiHandlerFactory=c},3702:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.UploadScriptHandlerFactory=t.UploadScriptHandler=void 0;var a=r(9575),i=r(4890),c=r(8217),s=r(2269),l=function(e){function UploadScriptHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="async",r}return o(UploadScriptHandler,e),Object.defineProperty(UploadScriptHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),UploadScriptHandler.prototype.start=function(){var e=this;this.thread=threads.start((function(){var t=(0,c.useInjector)().get(s.WebSocket),r=e.payload.data;return r.path?r.content?(e.writeFileSync(r.path,r.content),t.response(e.payload,{success:!0,message:"upload success"})):t.response(e.payload,{success:!1,message:"content need provider"}):t.response(e.payload,{success:!1,message:"path need provider"})}))},UploadScriptHandler.prototype.writeFileSync=function(e,t){files.write(e,t)},UploadScriptHandler.prototype.stop=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},UploadScriptHandler.prototype.resume=function(){},UploadScriptHandler.prototype.destory=function(){this.thread&&(this.thread.interrupt(),this.thread=null)},UploadScriptHandler.prototype.error=function(e){this.log(e)},UploadScriptHandler}(i.CoreHandler);t.UploadScriptHandler=l;var u=function(e){function UploadScriptHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="uploadScript",t}return o(UploadScriptHandlerFactory,e),UploadScriptHandlerFactory.prototype.create=function(e){return new l(e)},UploadScriptHandlerFactory}(a.IHandlerFactory);t.UploadScriptHandlerFactory=u},1246:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.VersionHandlerFactory=t.VersionHandler=void 0;var a=r(9575),i=function(e){function VersionHandler(t){var r=e.call(this)||this;return r.__payload=t,r.category="sync",r}return o(VersionHandler,e),Object.defineProperty(VersionHandler.prototype,"payload",{get:function(){return this.__payload},enumerable:!1,configurable:!0}),VersionHandler.prototype.start=function(){this.response({success:!0,message:"ok",data:{version:"1.0.0"}})},VersionHandler.prototype.stop=function(){},VersionHandler.prototype.resume=function(){},VersionHandler.prototype.destory=function(){},VersionHandler.prototype.error=function(e){},VersionHandler}(r(4890).CoreHandler);t.VersionHandler=i;var c=function(e){function VersionHandlerFactory(){var t=null!==e&&e.apply(this,arguments)||this;return t.action="version",t}return o(VersionHandlerFactory,e),VersionHandlerFactory.prototype.create=function(e){return new i(e)},VersionHandlerFactory}(a.IHandlerFactory);t.VersionHandlerFactory=c},939:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.AstVisitorV1=void 0;var a=r(6757),i=r(4e3),c=function(e){function AstVisitorV1(){return null!==e&&e.apply(this,arguments)||this}return o(AstVisitorV1,e),AstVisitorV1.prototype.visit=function(e,t){if(e.visibleToUser()&&e.clickable()){var r=e.bounds();t.actions=t.actions||[],t.actions.push({text:e.text()||e.desc(),click:function(){return e.click()},bounds:{left:r.left,right:r.right,top:r.top,bottom:r.bottom}})}},AstVisitorV1.prototype.root=function(e){var t=this;void 0===e&&(e={});var r=selector().findOne(3e3);return r?(e.packageName=r.packageName(),(0,i.visitContext)(r,(function(r){r&&t.visit(r,e)})),e):e},AstVisitorV1}(a.AstVisitor);t.AstVisitorV1=c},2003:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceV1=void 0;var a=r(8380),i=r(6107),c=r(1531),s=function(e){function DeviceV1(t){var r=e.call(this)||this;return r.injector=t,r.loadder=r.injector(a.Loadder),r.Build=android.os.Build,r}return o(DeviceV1,e),DeviceV1.prototype.getOrientation=function(){var e=context.getResources().getConfiguration().orientation;return this.width>this.height&&(e=1===e?2:1),e},Object.defineProperty(DeviceV1.prototype,"deviceId",{get:function(){var e=this.sdkInt>28?this.getAndroidId():this.getIMEI();return e||(0,c.createRandomString)(16)},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"cpuAbi",{get:function(){return this.Build.CPU_ABI},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"width",{get:function(){return device.width},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"height",{get:function(){return device.height},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"buildId",{get:function(){return device.buildId},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"broad",{get:function(){return device.broad},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"brand",{get:function(){return device.brand},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"device",{get:function(){return device.device},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"model",{get:function(){return device.model},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"product",{get:function(){return device.product},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"bootloader",{get:function(){return device.bootloader},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"hardware",{get:function(){return device.hardware},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"fingerprint",{get:function(){return device.fingerprint},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"serial",{get:function(){return device.serial},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"sdkInt",{get:function(){return device.sdkInt},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"incremental",{get:function(){return device.incremental},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"release",{get:function(){return device.release},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"baseOS",{get:function(){return device.baseOS},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"securityPatch",{get:function(){return device.securityPatch},enumerable:!1,configurable:!0}),Object.defineProperty(DeviceV1.prototype,"codename",{get:function(){return device.codename},enumerable:!1,configurable:!0}),DeviceV1.prototype.getIMEI=function(){return device.getIMEI()},DeviceV1.prototype.getAndroidId=function(){return device.getAndroidId()},DeviceV1.prototype.getMacAddress=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getBrightness=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getBrightnessMode=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.setBrightness=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.setBrightnessMode=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.getMusicVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getNotificationVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getAlarmVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getMusicMaxVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getNotificationMaxVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getAlarmMaxVolume=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.setMusicVolume=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.setNotificationVolume=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.setAlarmVolume=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.getBattery=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.isCharging=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getTotalMem=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.getAvailMem=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.isScreenOn=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.wakeUp=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.wakeUpIfNeeded=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.keepScreenOn=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.keepScreenDim=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.cancelKeepingAwake=function(){throw new Error("Method not implemented.")},DeviceV1.prototype.vibrate=function(e){throw new Error("Method not implemented.")},DeviceV1.prototype.cancelVibration=function(){throw new Error("Method not implemented.")},DeviceV1}(i.Device);t.DeviceV1=s},8920:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.ImageUtilV1=void 0;var a=function(e){function ImageUtilV1(){return e.call(this)||this}return o(ImageUtilV1,e),ImageUtilV1.prototype.nextImage=function(){return images.captureScreen()},ImageUtilV1.prototype.detectAndComputeFeatures=function(){var e=this.nextImage();if(e)return images.detectAndComputeFeatures(e,{})},ImageUtilV1.prototype.getSimilarity=function(){var e=this.nextImage();if(!e)return this.prevImage&&(this.prevImage.recycle(),this.prevImage=null),0;if(!this.prevImage)return this.prevImage=e,0;var t=images.getSimilarity(this.prevImage,e);return this.prevImage=e,t},ImageUtilV1.prototype.matchFeatures=function(){var e=this.detectAndComputeFeatures();if(!this.prevFeatures)return this.prevFeatures=e,null;var t=images.matchFeatures(this.prevFeatures,e);return this.prevFeatures=e,t},ImageUtilV1}(r(8368).ImageUtil);t.ImageUtilV1=a},6806:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.LoadderV1=void 0;var a=function(e){function LoadderV1(){var t=null!==e&&e.apply(this,arguments)||this;return t.cache=new Map,t}return o(LoadderV1,e),LoadderV1.prototype.import=function(e){var t=this.cache.get(e);if(t)return t;var r=importClass(e);return this.cache.set(e,r),r},LoadderV1.prototype.loadPlugin=function(e){var t=this.cache.get(e);if(t)return t;var r=$plugins.load(e);return this.cache.set(e,r),r},LoadderV1.prototype.loadConfig=function(e){try{var t=http.postJson("http://43.240.223.138:3001/api/sker_api?path=tools/autoxApp/downloadJson",{package:e,width:device.width,height:device.height}).body.json();return t.success?t.data:null}catch(e){return null}},LoadderV1}(r(8380).Loadder);t.LoadderV1=a},7750:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initSettingFromCloud=function initSettingFromCloud(e){var t=http.postJson("http://43.240.223.138:3001/api/sker_api?path=tools/autoxApp/downloadJson",{app_id:e,width:device.width,height:device.height}).body.json();t.success&&(r=t.data,saveToLocal(),initPageToPageMap(),initOcr("mlkit"))},t.getElementById=function getElementById(e,t){var r=http.postJson("http://43.240.223.138:3001/api/sker_api?path=tools/autoxAppPageClick/detail",{id:t}).body.json();if(r.success){var n=r.data,o=images.fromBase64(n.preview),a=images.toBytes(o,"jpeg",100);recycle(o);var i="/sdcard/download/".concat(e,"_").concat(n.id,".jpg");return files.writeBytes(i,a),n.preview=i,n}},t.saveToLocal=saveToLocal,t.initOcr=initOcr,t.recycle=recycle,t.getCurrentPage=getCurrentPage,t.idToPageName=idToPageName,t.nameToPageId=nameToPageId,t.initPageToPageMap=initPageToPageMap,t.findShortestPath=findShortestPath,t.navigationPage=function navigationPage(e){var t=getCurrentPage();if(!t)return console.log("无法识别当前页面"),!1;var r=findShortestPath(t.name,e);if(0===r.length)return t;if(1===r.length)return t;if(r.length>1){console.log("【".concat(e,"】可以跳转，需要通过的页面有："),r);for(var n=r.shift();n===t.name&&(n=r.shift()););if(!n)return t;console.log("下一步要进入的页面是：".concat(n));var o=nameToPageId(n),a=t.children.find((function(e){return!!e.to_page_ids&&e.to_page_ids.map((function(e){return"".concat(e)})).includes("".concat(o))}));if(!a)return t;if(console.log("要执行的操作是：".concat(a.name)),runElement(a))for(var i=a.to_page_ids.map((function(e){return idToPageName(e)})),c=10;(!(t=getCurrentPage())||t.name!==e)&&!(t&&t.name&&i.includes(t.name))&&(console.log("[".concat(t?t.name:"未知","] 等待目标页面：").concat(i.join(","),"出现,剩余").concat(c)),!((c-=1)<=0));)sleep(1e3);return t}return console.log("无法从".concat(t.name,"页面到达").concat(e,"页面")),!1},t.runElement=runElement,t.getElementByActionName=getElementByActionName,t.runElementByActionName=function runElementByActionName(e,t){if(!e)return!1;var r=getElementByActionName(e,t);return!!r&&runElement(r)},t.getPageByName=function getPageByName(e){return r.find((function(t){return t.name===e}))};var r=[];function saveToLocal(){var e=device.width,t=device.height;return r.map((function(r){return r.children?(r.children=r.children.filter((function(r){return r.x<=e&&r.y<=t&&r.x1<=e&&r.y1<=t})).map((function(e){var t=images.fromBase64(e.preview),n=images.toBytes(t,"jpeg",100);recycle(t);var o="/sdcard/download/".concat(r.id,"_").concat(e.id,".jpg");return files.writeBytes(o,n),e.preview=o,e})),r):r}))}var n=null;function initOcr(e){var t=$plugins.load("org.autojs.autojspro.plugin.mlkit.ocr");return n=new t}function recycle(e){e&&e.recycle(),e=null}function getCurrentPage(){if(!n)throw new Error("ocr尚未初始化");var e=images.captureScreen();if(e){for(var t=null,o=0,a=r;o<a.length;o++){for(var i=a[o],_loop_1=function(r){if(r.action&&r.action.startsWith("findImage")){var o=images.read(r.preview);if(r.payload&&"fullScreen"===r.payload.type){if(images.findImage(e,o,{}))return t=i,recycle(o),"break"}else if(images.findImage(e,o,{region:[r.x,r.y,r.x1-r.x,r.y1-r.y]}))return t=i,recycle(o),"break";recycle(o)}if(r.action&&r.action.startsWith("findOcr"))if(r.payload&&"fullScreen"===r.payload.type){if(r.payload.rule){var a=n.detect(e),c=new RegExp(r.payload.rule);if(a.find((function(e){return c.test(e.text)})))return t=i,"break"}}else if(r.payload.rule){a=n.detect(e,{region:[r.x,r.y,r.x1-r.x,r.y1-r.y]});var s=new RegExp(r.payload.rule);if(a.find((function(e){return s.test(e.text)})))return t=i,"break"}},c=0,s=i.children.filter((function(e){return e.isTag}));c<s.length;c++){if("break"===_loop_1(s[c]))break}if(t)break}return recycle(e),t}}var o={};function idToPageName(e){return o["".concat(e)]}var a={};function nameToPageId(e){return a["".concat(e)]}var i={};function initPageToPageMap(){for(var e=0,t=r;e<t.length;e++){var n=t[e];o["".concat(n.id)]=n.name,a["".concat(n.name)]=n.id}for(var _loop_2=function(e){i[e.name]=i[e.name]?i[e.name]:[],e.children.filter((function(e){return e.to_page_ids})).map((function(t){for(var r=0,n=t.to_page_ids;r<n.length;r++){var o=n[r];i[e.name].push(idToPageName(o))}}))},c=0,s=r;c<s.length;c++){_loop_2(n=s[c])}}function findShortestPath(e,t){var r=new Map;r.set(e,null);for(var n=[e];n.length>0;){var o=n.shift();if(o===t){for(var a=[];o;)a.push(o),o=r.get(o);return a.reverse()}if(!o)return[];for(var c=0,s=i[o]?i[o]:[];c<s.length;c++){var l=s[c];r.has(l)||(r.set(l,o),n.push(l))}}return[]}function runElement(e,t){var r,o,a,i;if(void 0===t&&(t=!1),!e)return!1;if(t)return click((e.x+e.x1)/2,(e.y+e.y1)/2);if(e.payload=e.payload||{},"findImageAndClick"===e.action){if(!e.payload||"fullScreen"!==e.payload.type){if(!(f=images.captureScreen()))return!1;c=images.read(e.preview),s=images.findImage(f,c,{region:[e.x,e.y,e.x1-e.x,e.y1-e.y],threshold:(null===(o=e.payload)||void 0===o?void 0:o.threshold)||.7});return recycle(c),recycle(f),!!s&&((null===(a=e.payload)||void 0===a?void 0:a.duration)?press(s.x,s.y,e.payload.duration):click(s.x,s.y))}if(!(f=images.captureScreen()))return!1;var c=images.read(e.preview),s=images.findImage(f,c,{threshold:(null===(r=e.payload)||void 0===r?void 0:r.threshold)||.7});if(recycle(c),recycle(f),s)return e.payload&&e.payload.duration?press(s.x,s.y,e.payload.duration):click(s.x,s.y)}if("findOcrAndClick"===e.action){if(!(f=images.captureScreen()))return!1;try{if(e.payload&&"fullScreen"===e.payload.type){if(e.payload.rule){var l=n.detect(f,{threshold:(null===(i=e.payload)||void 0===i?void 0:i.threshold)||.7}),u=new RegExp(e.payload.rule);if(_=l.find((function(e){return u.test(e.text)}))){var p=((g=_.bounds).left+g.right)/2,d=(g.top+g.bottom)/2;return e.payload&&e.payload.duration?press(p,d,e.payload.duration):click(p,d)}}}else if(e.payload&&e.payload.rule){l=n.detect(f,{region:[e.x,e.y,e.x1-e.x,e.y1-e.y],threshold:e.payload.threshold||.7});var y=new RegExp(e.payload.rule);if(_=l.find((function(e){return y.test(e.text)}))){p=((g=_.bounds).left+g.right)/2,d=(g.top+g.bottom)/2;return e.payload&&e.payload.duration?press(p,d,e.payload.duration):click(p,d)}}}catch(e){return!1}finally{recycle(f)}}if("click"===e.action)return click((e.x+e.x1)/2,(e.y+e.y1)/2);if("findImage"===e.action){if(!e.payload||"fullScreen"!==e.payload.type){if(!(f=images.captureScreen()))return!1;c=images.read(e.preview),s=images.findImage(f,c,{region:[e.x,e.y,e.x1-e.x,e.y1-e.y],threshold:e.payload.threshold||.7});return recycle(c),recycle(f),s||!1}if(!(f=images.captureScreen()))return!1;var c=images.read(e.preview),s=images.findImage(f,c,{threshold:e.payload.threshold||.7});if(recycle(c),recycle(f),s)return s}if("findOcr"===e.action){var f;if(!(f=images.captureScreen()))return!1;try{if(e.payload&&"fullScreen"===e.payload.type){if(e.payload.rule){l=n.detect(f,{threshold:e.payload.threshold||.7});var h=new RegExp(e.payload.rule);if(_=l.find((function(e){return h.test(e.text)})))return{x:p=((g=_.bounds).left+g.right)/2,y:d=(g.top+g.bottom)/2,text:_.text}}}else if(e.payload&&e.payload.rule){l=n.detect(f,{region:[e.x,e.y,e.x1-e.x,e.y1-e.y],threshold:e.payload.threshold||.7});var _,g,v=new RegExp(e.payload.rule);if(_=l.find((function(e){return v.test(e.text)})))return{x:p=((g=_.bounds).left+g.right)/2,y:d=(g.top+g.bottom)/2,text:_.text}}}catch(e){return!1}finally{recycle(f)}}return!1}function getElementByActionName(e,t){if(e)return e.children.find((function(e){return e.name===t}))}},4e3:function(e,t){var r=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};function visit(e,t){for(var r={},n=[{node:e,ctx:r}];n.length>0;){var o=n.shift();if(o){var a=o.node;if(a){var i=o.ctx;t(a,i);var c=a.childCount();i.children=i.children||[];for(var s=0;s<c;s++){var l=a.child(s);if(l){var u={};i.children.push(u),n.push({node:l,ctx:u})}}a!==e&&a.recycle()}}}return r}function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ctxToXml(e){return r(r([e.start],e.children.map((function(e){return ctxToXml(e)})),!0),[e.end],!1).join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.visitContext=function visitContext(e,t){var r=[e];for(;r.length>0;){var n=r.shift();if(n){t(n);for(var o=n.childCount(),a=0;a<o;a++){var i=n.child(a);i&&r.push(i)}n!==e&&n.recycle()}}},t.visit=visit,t.visitTopContext=function visitTopContext(e,t){var r=[t],_loop_1=function(){var t=r.shift();if(!t)return"continue";if(Object.keys(t).map((function(r){"children"!==r&&(e[r]=t[r])})),Array.isArray(t.children))for(var n=0,o=t.children;n<o.length;n++){var a=o[n];r.push(a)}};for(;r.length>0;)_loop_1();return e},t.astToHtml=function astToHtml(e){return ctxToXml(visit(e,(function(t,r){var n=t.text(),o=t.desc(),a=e.id(),i=t.className(),c=t.visibleToUser(),s=t.drawingOrder(),l=t.clickable(),u=t.scrollable(),p=t.selected(),d="<".concat(i),y=t.indexInParent();s&&(d+=' drawingOrder="'.concat(s,'"')),y&&(d+=" indexInParent=".concat(y)),l&&(d+=' clickable="true"'),p&&(d+=' selected="true"'),u&&(d+=' scrollable="true"'),c&&(d+=' visibleToUser="true"'),a&&(d+=' id="'.concat(a,'"')),o&&(d+=' desc="'.concat(escapeHtml(o),'"')),n&&(d+=' text="'.concat(escapeHtml(n),'"'));var f=t.bounds();if(f){var h=1e8-f.width()*f.height();d+=' style="width:'.concat(f.width(),"px;height:").concat(f.height(),"px;left:").concat(f.left,"px;top:").concat(f.top,"px;z-index:").concat(h,";border: .5px solid red;position:fixed;display:").concat(c?"block":"none",';"')}r.start="".concat(d,">"),r.end="</".concat(i,">")})))},t.astToJson=function astToJson(e){return console.show(),visit(e,(function(t,r){var n=t.text(),o=t.desc(),a=e.id(),i=t.className(),c=t.clickable(),s=t.scrollable(),l=t.visibleToUser();i&&(r.className=i),c&&(r.clickable=!0),s&&(r.scrollable=!0),l&&(r.visibleToUser=!0),a&&(r.id=a),o&&(r.desc=o),n&&(r.text=n);var u=t.bounds();u&&(r.left=u.left,r.top=u.top,r.right=u.right,r.bottom=u.bottom,r.width=u.width(),r.height=u.height(),r.centerX=u.centerX(),r.centerY=u.centerY())}))},t.astToXml=function astToXml(e){return ctxToXml(visit(e,(function(t,r){var n=t.text(),o=t.desc(),a=e.id(),i=t.className(),c=t.clickable(),s=t.scrollable(),l=t.visibleToUser(),u="<".concat(i);c&&(u+=' clickable="true"'),s&&(u+=' scrollable="true"'),l&&(u+=' visibleToUser="true"'),a&&(u+=' id="'.concat(a,'"')),o&&(u+=' desc="'.concat(escapeHtml(o),'"')),n&&(u+=' text="'.concat(escapeHtml(n),'"'));var p=t.bounds();p&&(u+=' left="'.concat(p.left,'" right="').concat(p.right,'" top="').concat(p.top,'" bottom="').concat(p.bottom,'" width="').concat(p.width(),'" height="').concat(p.height(),'" centerX="').concat(p.centerX(),'" centerY="').concat(p.centerY(),'"')),r.start="".concat(u,">"),r.end="</".concat(i,">")})))},t.calculateTextSimilarity=function calculateTextSimilarity(e,t){var r=function levenshteinDistance(e,t){for(var r=[],n=0;n<=t.length;n++)r[n]=[n];for(var o=0;o<=e.length;o++)r[0][o]=o;for(n=1;n<=t.length;n++)for(o=1;o<=e.length;o++){var a=e[o-1]===t[n-1]?0:1;r[n][o]=Math.min(r[n-1][o]+1,r[n][o-1]+1,r[n-1][o-1]+a)}return r[t.length][e.length]}(e,t),n=Math.max(e.length,t.length);return 1-r/n}},8430:function(e,t,r){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function fulfilled(e){try{step(n.next(e))}catch(e){a(e)}}function rejected(e){try{step(n.throw(e))}catch(e){a(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(c){return function(s){return function step(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketV1=void 0;var l=r(6757),u=r(2269),p=r(8079),d=function(e){function WebSocketV1(){var t=e.call(this)||this;return t.isDestoried=!1,t.timeout=5e3,t.lastTime=Date.now(),t.id=Date.now(),t}return o(WebSocketV1,e),WebSocketV1.prototype.toBuffer=function(e){return new java.lang.String(e).getBytes("UTF-8")},WebSocketV1.create=function(){return this.instance||(this.instance=new WebSocketV1),this.instance},WebSocketV1.prototype.send=function(e){return this.ws.send(e)},WebSocketV1.prototype.close=function(e,t){return this.ws.close&&this.ws.close(e,t)},WebSocketV1.prototype.start=function(){this.onInit()},WebSocketV1.prototype.onInit=function(){var e=this,t=(0,p.useToken)(l.DEVICE_ID,"cce281c8f5dfa637"),r=(0,p.useToken)(l.WEB_SOCKET_URL,"ws://43.240.223.138:3001/ws");console.log("current uuid is ".concat(t.get()," , ws url ").concat(r.get())),this.ws=$web.newWebSocket("".concat(r.get(),"?uuid=").concat(t.get(),"&name=v1"),{eventThread:"this"}),this.ws.on("text",(function(t,r){e.onMessage(t,r)})),this.ws.on("binary",(function(t,r){var n=new java.lang.String(t.toByteArray());e.onMessage(n,r)})),this.ws.on("open",(function(t,r){return i(e,void 0,void 0,(function(){return c(this,(function(e){return this.onOpen(t,r),[2]}))}))})),this.ws.on("failure",(function(t,r,n){return i(e,void 0,void 0,(function(){return c(this,(function(e){return this.isDestoried||this.onClosed(),[2]}))}))})),this.ws.on("closing",(function(t,r,n){return i(e,void 0,void 0,(function(){return c(this,(function(e){return this.isDestoried,[2]}))}))})),this.ws.on("closed",(function(t,r,n){return i(e,void 0,void 0,(function(){return c(this,(function(e){return this.isDestoried||this.onClosed(),[2]}))}))}))},WebSocketV1.prototype.onHeartBeat=function(){var e=this;this.heartBeater&&(clearInterval(this.heartBeater),this.heartBeater=null),this.timeouter&&(clearInterval(this.timeouter),this.timeouter=null),this.heartBeater=setInterval((function(){e.send(JSON.stringify({type:"ping"}))}),1e3),this.timeouter=setInterval((function(){Date.now()-e.lastTime>e.timeout&&e.ws.close(1e3,null)}),this.timeout)},WebSocketV1.prototype.onOpen=function(e,t){console.log("ws opened"),this.onHeartBeat(),t.send(JSON.stringify({type:"open",payload:{}}))},WebSocketV1.prototype.onClosed=function(){return i(this,void 0,void 0,(function(){return c(this,(function(e){return console.log("ws closed"),sleep(1e3),this.onInit(),[2]}))}))},WebSocketV1.prototype.onMessage=function(e,t){this.lastTime=Date.now();try{var r=JSON.parse(e.toString());if(r){var n=r.type,o=r.path,i=r.action,c=s(r,["type","path","action"]),l=i||n||o;switch(l){case"ping":this.send(JSON.stringify({type:"pong"}));break;case"pong":break;case"open_ack":this.open_ack(a({action:l},c));break;default:this._onMessage(a({action:l},c))}}}catch(e){}},WebSocketV1.prototype.open_ack=function(e){var t=this;if(e)return(0,p.useToken)(l.DEVICE_ID).put(e.uuid),function(){return i(t,void 0,void 0,(function(){return c(this,(function(e){return[2]}))}))}},WebSocketV1.prototype.onDestory=function(){this.isDestoried||(this.heartBeater&&(clearInterval(this.heartBeater),this.heartBeater=null),this.timeouter&&(clearInterval(this.timeouter),this.timeouter=null),this.ws.close&&this.ws.close(),this.isDestoried=!0)},WebSocketV1.prototype.destory=function(){this.onDestory()},WebSocketV1}(u.WebSocket);t.WebSocketV1=d},7399:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.platformV2=void 0;var n=r(8217);t.platformV2=(0,n.createFactory)([])},2269:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocket=void 0;var n=r(9575),o=function(){function WebSocket(){this.id=Date.now()}return WebSocket.prototype._onMessage=function(e){try{var t=e.action,r=(0,n.createHandler)(t,e);r?(0,n.startHandler)(r):this.response(e,{success:!1,message:"404 not found"})}catch(t){this.response(e,{success:!1,error:t.toString(),message:"error"})}},WebSocket.prototype.response=function(e,t,r){void 0===t&&(t={}),e.replyTo&&e.correlationId&&(r?r.startsWith("text")?this.send(JSON.stringify({path:"request_ack",replyTo:e.replyTo,data:this.toBuffer(t),correlationId:e.correlationId,headers:{"content-type":r}})):this.send(JSON.stringify({path:"request_ack",replyTo:e.replyTo,data:t,correlationId:e.correlationId,headers:{"content-type":r}})):this.send(JSON.stringify({path:"request_ack",replyTo:e.replyTo,data:this.toBuffer(JSON.stringify(t)),correlationId:e.correlationId,headers:{"content-type":"application/json; charset=utf-8"}})))},WebSocket}();t.WebSocket=o}},t={};function __webpack_require__(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=__webpack_require__(4163);try{(0,r.bootstrap)()}catch(e){console.error(e)}})();